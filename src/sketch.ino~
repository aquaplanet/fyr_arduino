const int LED_PIN = 13;
const int BTN_PIN = 2;

int isOn = false;
int btnState = HIGH;
int oldBtnState = HIGH;

unsigned long time;

void toggleBtn() {
  oldBtnState = btnState;
  btnState = digitalRead(BTN_PIN);

  if (btnState == HIGH && oldBtnState == LOW) {
    isOn = ! isOn;
    delay(10);
  }

}

void setup()
{
  pinMode(LED_PIN, OUTPUT);
  pinMode(BTN_PIN, INPUT);
}

// See http://sv.wikipedia.org/wiki/Fyrkarakt%C3%A4r
// http://fyr.org/ehfyrvst.htm
void vinga_ostra_nedre() {
  int modTime = time % 4000;

  if (modTime < 500) {
    digitalWrite(LED_PIN, LOW);
  } else {
    digitalWrite(LED_PIN, HIGH);
  }
}

void loop()
{
  toggleBtn();

  time = millis();

  if (isOn) {
    vinga_ostra_nedre();
  } else {
    digitalWrite(LED_PIN, LOW);
  }

}
